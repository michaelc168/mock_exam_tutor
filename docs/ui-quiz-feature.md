# 答題功能實作說明

根據提供的 UI 截圖，已完成以下功能。

---

## 📱 新增的頁面

### 1. 答題頁面 `/quiz/[examId]`

**路徑**：`frontend/app/quiz/[examId]/page.tsx`

**功能**：
- ✅ 顯示題目和 4 個選項
- ✅ 選項選擇（點擊高亮顯示）
- ✅ 進度條（頂部藍色條）
- ✅ 題目計數（右上角「1 / 5」）
- ✅ 導航按鈕（上一題、下一題）
- ✅ 點狀進度指示器（底部）
- ✅ 最後一題顯示「提交答案」

**UI 特色**：
```
┌─────────────────────────────────────┐
│ Header + Progress Bar               │
├─────────────────────────────────────┤
│ [返回]      國語科         [1/5]    │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │  第 1 題                         │ │
│ │                                 │ │
│ │  下列哪個詞語的用法是正確的？      │ │
│ │                                 │ │
│ │  ⭕ A  他「淋漓盡致」地...        │ │
│ │  ⚪ B  這道菜味道「栩栩如生」      │ │
│ │  ⚪ C  她「鬼斧神工」地...        │ │
│ │  ⚪ D  天空「波瀾壯闊」地...      │ │
│ └─────────────────────────────────┘ │
│                                     │
│ [上一題]  ●●○○○  [下一題 →]      │
└─────────────────────────────────────┘
```

---

### 2. 結果頁面 `/quiz/[examId]/result`

**路徑**：`frontend/app/quiz/[examId]/result/page.tsx`

**功能**：
- ✅ 顯示總分和統計（答對、答錯、正確率）
- ✅ 藍色漸層成績卡片
- ✅ 逐題檢討（綠色=答對、紅色=答錯）
- ✅ 顯示正確答案對照
- ✅ 返回首頁 / 查看所有考卷按鈕

**UI 特色**：
```
┌─────────────────────────────────────┐
│ 🏆 測驗完成！                        │
│    國語科                            │
│    80 分                             │
│    4 答對 | 1 答錯 | 80% 正確率      │
├─────────────────────────────────────┤
│ 答案檢討                             │
│                                     │
│ ✅ 第 1 題 [答對]                    │
│    下列哪個詞語的用法是正確的？        │
│    你的答案：(A)                     │
│                                     │
│ ❌ 第 2 題 [答錯]                    │
│    「春天像個害羞的小姑娘...」        │
│    你的答案：(A)                     │
│    正確答案：(B)                     │
└─────────────────────────────────────┘
```

---

### 3. 考卷列表頁面（已修改）

**新增功能**：
- ✅ 每個考卷新增「開始作答」按鈕
- ✅ 點擊後跳轉到答題頁面

---

## 🔧 後端 API 新增

### 新增的端點

| 方法 | 路徑 | 說明 |
|------|------|------|
| GET | `/api/quiz/{exam_id}` | 取得考卷供答題（不含答案） |
| POST | `/api/quiz/submit` | 提交答案並評分 |

### API 請求/回應範例

#### 1. 取得考卷

**請求**：
```
GET /api/quiz/mock-exam-20260209-comprehensive
```

**回應**：
```json
{
  "exam_id": "mock-exam-20260209-comprehensive",
  "title": "模擬考試",
  "subject": "國語科",
  "total_questions": 5,
  "questions": [
    {
      "id": 1,
      "subject": "國語科",
      "question": "下列哪個詞語的用法是正確的？",
      "options": [
        { "label": "A", "text": "他「淋漓盡致」地表達..." },
        { "label": "B", "text": "這道菜味道「栩栩如生」。" },
        { "label": "C", "text": "她「鬼斧神工」地完成..." },
        { "label": "D", "text": "天空「波瀾壯闊」地..." }
      ]
    }
  ]
}
```

#### 2. 提交答案

**請求**：
```json
POST /api/quiz/submit
{
  "exam_id": "mock-exam-20260209-comprehensive",
  "answers": [
    { "question_id": 1, "user_answer": "A" },
    { "question_id": 2, "user_answer": "B" },
    ...
  ]
}
```

**回應**：
```json
{
  "exam_id": "mock-exam-20260209-comprehensive",
  "subject": "國語科",
  "total_questions": 5,
  "correct_count": 4,
  "score": 80,
  "answers": [
    {
      "question_id": 1,
      "question": "下列哪個詞語...",
      "user_answer": "A",
      "correct_answer": "A",
      "is_correct": true
    }
  ]
}
```

---

## 🎯 完整使用流程

### 用戶視角

1. **首頁** → 點擊「開始出題」→ 生成考卷
2. **考卷列表** → 點擊「開始作答」→ 進入答題頁面
3. **答題頁面** → 選擇答案 → 點擊「下一題」→ 繼續作答
4. **提交答案** → 查看結果頁面
5. **結果頁面** → 查看分數和詳細檢討

### 技術流程

```
前端請求考卷
    ↓
GET /api/quiz/{exam_id}
    ↓
後端解析 Markdown，提取題目（不含答案）
    ↓
返回題目資料給前端
    ↓
用戶作答
    ↓
POST /api/quiz/submit {exam_id, answers}
    ↓
後端比對答案，計算分數
    ↓
返回結果（分數、逐題檢討）
    ↓
前端顯示結果頁面
```

---

## 🚧 待完成的工作

### 高優先級

1. **Markdown 解析器**
   - 解析考卷 Markdown 提取題目和答案
   - 將題目轉換為 JSON 格式

2. **答案儲存**
   - 將用戶答題記錄存入資料庫或檔案
   - 支援歷史成績查詢

3. **計時器功能**
   - 添加倒數計時
   - 時間到自動提交

### 中優先級

4. **多科目支援**
   - 根據考卷內容自動識別科目
   - 支援國語、英語、數學分開作答

5. **答題進度保存**
   - LocalStorage 保存進度
   - 刷新頁面不會丟失

6. **答題統計**
   - 歷史成績圖表
   - 錯題統計分析

---

## 📝 目前狀態

| 功能 | 前端 | 後端 | 狀態 |
|------|------|------|------|
| 答題介面 | ✅ | - | 完成 |
| 題目導航 | ✅ | - | 完成 |
| 選項選擇 | ✅ | - | 完成 |
| 進度顯示 | ✅ | - | 完成 |
| 結果頁面 | ✅ | - | 完成 |
| 取得考卷 API | - | ✅ | 模擬資料 |
| 提交答案 API | - | ✅ | 模擬資料 |
| Markdown 解析 | - | ⏳ | 待完成 |
| 答案比對 | - | ⏳ | 待完成 |

---

## 💡 下一步建議

1. 先測試前端 UI（使用模擬資料）
2. 實作 Markdown 解析器（解析考卷題目）
3. 整合真實資料
4. 添加計時器和進度保存

---

已完成答題功能的基礎框架！現在可以啟動系統測試：

```bash
./start-dev.sh
```

然後訪問 http://localhost:3000，在考卷列表中點擊「開始作答」即可體驗！
